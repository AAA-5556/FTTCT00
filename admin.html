<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>پنل مدیریت</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="impersonation-banner" style="display: none;">
        <p>شما در حال مشاهده پنل به عنوان یک کاربر دیگر هستید.</p>
        <button id="end-impersonation-btn">بازگشت به پنل اصلی</button>
    </div>

    <div class="page-container">
        <header class="page-header">
            <div class="header-content">
                <img src="logo.png" alt="لوگو" class="logo">
                <h1 id="admin-title">پنل مدیریت</h1>
            </div>
            <div class="header-actions">
                <div class="main-menu">
                    <button id="main-menu-button" class="btn">منو اصلی</button>
                    <div id="main-menu-dropdown" class="dropdown-content">
                        <a href="action-log.html">گزارش فعالیت‌ها</a>
                        <a href="login-log.html">گزارش ورودها</a>
                    </div>
                </div>
                <button id="logout-button" class="btn">خروج</button>
            </div>
        </header>

        <main>
            <!-- Tab Navigation -->
            <div class="tab-container">
                <button class="tab-link active" data-tab="user-management">مدیریت کاربران</button>
                <button class="tab-link" data-tab="attendance-report">گزارش حضور و غیاب</button>
            </div>

            <!-- Tab Content -->
            <div id="user-management" class="tab-content active">
                <section id="user-management-section" class="card">
                    <h2>افزودن <span id="role-to-add">کاربر</span> جدید</h2>
                    <form id="add-user-form" class="form-container">
                        <input type="text" id="new-username" placeholder="نام کاربری جدید" required>
                        <input type="password" id="new-password" placeholder="رمز عبور جدید" required>
                        <input type="hidden" id="new-user-role" value="">
                        <button type="submit" class="btn btn-primary">ایجاد کاربر</button>
                    </form>
                    <div id="status-message" class="status-message" style="display: none;"></div>
                </section>
                <section class="card">
                    <h2>داشبورد مدیریت</h2>
                    <div id="dashboard-container" class="dashboard-grid">
                        <p id="loading-message-dashboard">در حال بارگذاری...</p>
                    </div>
                </section>
            </div>

            <div id="attendance-report" class="tab-content">
                <section class="card">
                    <h2>فیلترها و خروجی</h2>
                    <div class="filters">
                        <select id="institution-filter"><option value="all">همه موسسات</option></select>
                        <input type="text" id="start-date-filter" placeholder="تاریخ شروع (مثال: 1402/01/01)">
                        <input type="text" id="end-date-filter" placeholder="تاریخ پایان (مثال: 1402/01/31)">
                        <div id="status-filter-buttons" class="status-filter">
                            <button class="filter-btn active" data-status="all">همه</button>
                            <button class="filter-btn" data-status="حاضر">حاضر</button>
                            <button class="filter-btn" data-status="غایب">غایب</button>
                        </div>
                        <button id="reset-filters" class="btn">حذف فیلترها</button>
                        <button id="export-excel" class="btn btn-primary">خروجی اکسل</button>
                    </div>
                </section>
                <section class="card">
                    <h2>نتایج گزارش</h2>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>موسسه</th>
                                    <th>نام عضو</th>
                                    <th>تاریخ و زمان</th>
                                    <th>وضعیت</th>
                                </tr>
                            </thead>
                            <tbody id="admin-data-body">
                                <tr><td colspan="4" id="loading-message-report">در حال بارگذاری...</td></tr>
                            </tbody>
                        </table>
                    </div>
                    <div id="pagination-container" class="pagination"></div>
                </section>
            </div>
        </main>
    </div>

    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="auth.js"></script>
    <script src="admin.js"></script>
</body>
</html>
